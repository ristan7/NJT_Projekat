{"ast":null,"code":"const API = \"/api\";\nfunction authHeaders() {\n  const h = {\n    \"Content-Type\": \"application/json\"\n  };\n  const token = typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\n  if (token) h.Authorization = `Bearer ${token}`;\n  return h;\n}\nexport async function request(path, {\n  method = \"GET\",\n  headers,\n  body,\n  params\n} = {}) {\n  const qs = params ? \"?\" + new URLSearchParams(Object.fromEntries(Object.entries(params).filter(([, v]) => v !== undefined && v !== null))).toString() : \"\";\n  const res = await fetch(`${API}${path}${qs}`, {\n    method,\n    headers: {\n      ...authHeaders(),\n      ...headers\n    },\n    body: body == null ? undefined : headers !== null && headers !== void 0 && headers[\"Content-Type\"] && headers[\"Content-Type\"] !== \"application/json\" ? body : JSON.stringify(body)\n  });\n  if (res.status === 401 || res.status === 403) {\n    try {\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"user\");\n    } catch {}\n    if (typeof window !== \"undefined\" && window.location.pathname !== \"/login\") {\n      window.location.href = \"/login\";\n    }\n    throw new Error(\"Unauthorized\");\n  }\n  const text = await res.text();\n  const data = text ? (() => {\n    try {\n      return JSON.parse(text);\n    } catch {\n      return text;\n    }\n  })() : null;\n  if (!res.ok) {\n    const msg = data && data.message || text || `HTTP ${res.status}`;\n    throw new Error(msg);\n  }\n  return data;\n}","map":{"version":3,"names":["API","authHeaders","h","token","window","localStorage","getItem","Authorization","request","path","method","headers","body","params","qs","URLSearchParams","Object","fromEntries","entries","filter","v","undefined","toString","res","fetch","JSON","stringify","status","removeItem","location","pathname","href","Error","text","data","parse","ok","msg","message"],"sources":["C:/Users/mikir/Documents/NetBeansProjects/NJT_Projekat/e_learning_platform_njt_frontend/src/api/fetcher.js"],"sourcesContent":["const API = \"/api\";\r\n\r\nfunction authHeaders() {\r\n    const h = { \"Content-Type\": \"application/json\" };\r\n    const token = typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\r\n    if (token) h.Authorization = `Bearer ${token}`;\r\n    return h;\r\n}\r\n\r\nexport async function request(path, { method = \"GET\", headers, body, params } = {}) {\r\n    const qs = params\r\n        ? \"?\" +\r\n        new URLSearchParams(\r\n            Object.fromEntries(\r\n                Object.entries(params).filter(([, v]) => v !== undefined && v !== null)\r\n            )\r\n        ).toString()\r\n        : \"\";\r\n\r\n    const res = await fetch(`${API}${path}${qs}`, {\r\n        method,\r\n        headers: { ...authHeaders(), ...headers },\r\n        body:\r\n            body == null\r\n                ? undefined\r\n                : headers?.[\"Content-Type\"] && headers[\"Content-Type\"] !== \"application/json\"\r\n                    ? body\r\n                    : JSON.stringify(body),\r\n    });\r\n\r\n    if (res.status === 401 || res.status === 403) {\r\n        try {\r\n            localStorage.removeItem(\"token\");\r\n            localStorage.removeItem(\"user\");\r\n        } catch { }\r\n        if (typeof window !== \"undefined\" && window.location.pathname !== \"/login\") {\r\n            window.location.href = \"/login\";\r\n        }\r\n        throw new Error(\"Unauthorized\");\r\n    }\r\n\r\n    const text = await res.text();\r\n    const data = text ? (() => { try { return JSON.parse(text); } catch { return text; } })() : null;\r\n\r\n    if (!res.ok) {\r\n        const msg = (data && data.message) || text || `HTTP ${res.status}`;\r\n        throw new Error(msg);\r\n    }\r\n    return data;\r\n}\r\n"],"mappings":"AAAA,MAAMA,GAAG,GAAG,MAAM;AAElB,SAASC,WAAWA,CAAA,EAAG;EACnB,MAAMC,CAAC,GAAG;IAAE,cAAc,EAAE;EAAmB,CAAC;EAChD,MAAMC,KAAK,GAAG,OAAOC,MAAM,KAAK,WAAW,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,GAAG,IAAI;EAClF,IAAIH,KAAK,EAAED,CAAC,CAACK,aAAa,GAAG,UAAUJ,KAAK,EAAE;EAC9C,OAAOD,CAAC;AACZ;AAEA,OAAO,eAAeM,OAAOA,CAACC,IAAI,EAAE;EAAEC,MAAM,GAAG,KAAK;EAAEC,OAAO;EAAEC,IAAI;EAAEC;AAAO,CAAC,GAAG,CAAC,CAAC,EAAE;EAChF,MAAMC,EAAE,GAAGD,MAAM,GACX,GAAG,GACL,IAAIE,eAAe,CACfC,MAAM,CAACC,WAAW,CACdD,MAAM,CAACE,OAAO,CAACL,MAAM,CAAC,CAACM,MAAM,CAAC,CAAC,GAAGC,CAAC,CAAC,KAAKA,CAAC,KAAKC,SAAS,IAAID,CAAC,KAAK,IAAI,CAC1E,CACJ,CAAC,CAACE,QAAQ,CAAC,CAAC,GACV,EAAE;EAER,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGxB,GAAG,GAAGS,IAAI,GAAGK,EAAE,EAAE,EAAE;IAC1CJ,MAAM;IACNC,OAAO,EAAE;MAAE,GAAGV,WAAW,CAAC,CAAC;MAAE,GAAGU;IAAQ,CAAC;IACzCC,IAAI,EACAA,IAAI,IAAI,IAAI,GACNS,SAAS,GACTV,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAG,cAAc,CAAC,IAAIA,OAAO,CAAC,cAAc,CAAC,KAAK,kBAAkB,GACvEC,IAAI,GACJa,IAAI,CAACC,SAAS,CAACd,IAAI;EACrC,CAAC,CAAC;EAEF,IAAIW,GAAG,CAACI,MAAM,KAAK,GAAG,IAAIJ,GAAG,CAACI,MAAM,KAAK,GAAG,EAAE;IAC1C,IAAI;MACAtB,YAAY,CAACuB,UAAU,CAAC,OAAO,CAAC;MAChCvB,YAAY,CAACuB,UAAU,CAAC,MAAM,CAAC;IACnC,CAAC,CAAC,MAAM,CAAE;IACV,IAAI,OAAOxB,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACyB,QAAQ,CAACC,QAAQ,KAAK,QAAQ,EAAE;MACxE1B,MAAM,CAACyB,QAAQ,CAACE,IAAI,GAAG,QAAQ;IACnC;IACA,MAAM,IAAIC,KAAK,CAAC,cAAc,CAAC;EACnC;EAEA,MAAMC,IAAI,GAAG,MAAMV,GAAG,CAACU,IAAI,CAAC,CAAC;EAC7B,MAAMC,IAAI,GAAGD,IAAI,GAAG,CAAC,MAAM;IAAE,IAAI;MAAE,OAAOR,IAAI,CAACU,KAAK,CAACF,IAAI,CAAC;IAAE,CAAC,CAAC,MAAM;MAAE,OAAOA,IAAI;IAAE;EAAE,CAAC,EAAE,CAAC,GAAG,IAAI;EAEhG,IAAI,CAACV,GAAG,CAACa,EAAE,EAAE;IACT,MAAMC,GAAG,GAAIH,IAAI,IAAIA,IAAI,CAACI,OAAO,IAAKL,IAAI,IAAI,QAAQV,GAAG,CAACI,MAAM,EAAE;IAClE,MAAM,IAAIK,KAAK,CAACK,GAAG,CAAC;EACxB;EACA,OAAOH,IAAI;AACf","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}